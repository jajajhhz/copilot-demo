Logitech Brio 105 USB Camera HTTP Driver

Overview
- Converts native USB UVC camera data to an HTTP interface.
- Provides a background frame collector and serves MJPEG live stream and single-frame capture.

Endpoints
- GET /stream
  - Continuous MJPEG stream (multipart/x-mixed-replace) from the camera.
  - Keep the HTTP connection open to receive frames.
- POST /capture
  - Returns a single JPEG image captured from the next available frame.
- GET /status
  - Returns a small JSON status payload: { ready, streaming, last_update_epoch_ms }.

Environment Variables
- HTTP_HOST: Host for HTTP server (default: 0.0.0.0)
- HTTP_PORT: Port for HTTP server (default: 8000)
- CAM_DEVICE: Camera device index (e.g., 0) or path (e.g., /dev/video0) (default: 0)
- CAM_WIDTH: Requested capture width (default: 1280)
- CAM_HEIGHT: Requested capture height (default: 720)
- CAM_FPS: Target frames per second (default: 30)
- JPEG_QUALITY: JPEG encode quality 1-100 (default: 85)
- BACKOFF_BASE_SECS: Initial reconnect backoff in seconds (default: 0.5)
- BACKOFF_MAX_SECS: Maximum reconnect backoff in seconds (default: 10)
- READ_ERRORS_BEFORE_REOPEN: Consecutive read errors before reopening device (default: 10)
- CAPTURE_TIMEOUT_SECS: Timeout for waiting for "next available frame" (default: 3.0)
- LOG_LEVEL: Logging level (DEBUG, INFO, WARNING, ERROR) (default: INFO)

Run
1) Install dependencies
   pip install -r requirements.txt

2) Export configuration (examples)
   export HTTP_PORT=8080
   export CAM_DEVICE=/dev/video0
   export CAM_WIDTH=1920
   export CAM_HEIGHT=1080
   export CAM_FPS=30

3) Start
   python driver.py

Quick Usage
- Live stream (in browser)
  Open: http://localhost:8080/stream

- Live stream (curl saves frames; note curl wonâ€™t display)
  curl -v http://localhost:8080/stream

- Capture single image to file
  curl -X POST http://localhost:8080/capture --output snapshot.jpg

- Status
  curl http://localhost:8080/status

Notes
- The driver continuously reads frames from the Logitech Brio 105 using USB UVC via OpenCV and maintains a thread-safe buffer.
- Resilience: automatic reconnect with exponential backoff; logs connect/disconnect, retries, errors, last update timestamps.
- Graceful shutdown: Ctrl+C (SIGINT) stops the HTTP server and the background collector cleanly.

Generated by [IoT Driver Copilot](https://copilot.test.shifu.dev/)
